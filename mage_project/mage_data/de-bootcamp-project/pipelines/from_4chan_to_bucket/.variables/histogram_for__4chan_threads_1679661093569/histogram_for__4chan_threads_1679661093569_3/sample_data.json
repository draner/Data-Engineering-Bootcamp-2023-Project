"{\"data\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mTypeError\\u001b[0m                                 Traceback (most recent call last)\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1567\\u001b[0m, in \\u001b[0;36mGroupBy.apply\\u001b[0;34m(self, func, *args, **kwargs)\\u001b[0m\\n\\u001b[1;32m   1564\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m rewrite_warning(\\n\\u001b[1;32m   1565\\u001b[0m         old_msg, \\u001b[38;5;167;01mFutureWarning\\u001b[39;00m, new_msg\\n\\u001b[1;32m   1566\\u001b[0m     ) \\u001b[38;5;28;01mif\\u001b[39;00m is_np_func \\u001b[38;5;28;01melse\\u001b[39;00m nullcontext():\\n\\u001b[0;32m-> 1567\\u001b[0m         result \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_python_apply_general\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_selected_obj\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m   1568\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mTypeError\\u001b[39;00m:\\n\\u001b[1;32m   1569\\u001b[0m     \\u001b[38;5;66;03m# gh-20949\\u001b[39;00m\\n\\u001b[1;32m   1570\\u001b[0m     \\u001b[38;5;66;03m# try again, with .apply acting as a filtering\\u001b[39;00m\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m   1574\\u001b[0m     \\u001b[38;5;66;03m# fails on *some* columns, e.g. a numeric operation\\u001b[39;00m\\n\\u001b[1;32m   1575\\u001b[0m     \\u001b[38;5;66;03m# on a string grouper column\\u001b[39;00m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1629\\u001b[0m, in \\u001b[0;36mGroupBy._python_apply_general\\u001b[0;34m(self, f, data, not_indexed_same, is_transform, is_agg)\\u001b[0m\\n\\u001b[1;32m   1601\\u001b[0m \\u001b[38;5;250m\\u001b[39m\\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[1;32m   1602\\u001b[0m \\u001b[38;5;124;03mApply function f in python space\\u001b[39;00m\\n\\u001b[1;32m   1603\\u001b[0m \\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m   1627\\u001b[0m \\u001b[38;5;124;03m    data after applying f\\u001b[39;00m\\n\\u001b[1;32m   1628\\u001b[0m \\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[0;32m-> 1629\\u001b[0m values, mutated \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mgrouper\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mapply\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mdata\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43maxis\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m   1630\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m not_indexed_same \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/ops.py:839\\u001b[0m, in \\u001b[0;36mBaseGrouper.apply\\u001b[0;34m(self, f, data, axis)\\u001b[0m\\n\\u001b[1;32m    838\\u001b[0m group_axes \\u001b[38;5;241m=\\u001b[39m group\\u001b[38;5;241m.\\u001b[39maxes\\n\\u001b[0;32m--> 839\\u001b[0m res \\u001b[38;5;241m=\\u001b[39m \\u001b[43mf\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    840\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m mutated \\u001b[38;5;129;01mand\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m _is_indexed_like(res, group_axes, axis):\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:101\\u001b[0m, in \\u001b[0;36mbuild_x_y.<locals>.<lambda>\\u001b[0;34m(group)\\u001b[0m\\n\\u001b[1;32m     98\\u001b[0m data[VARIABLE_NAME_X] \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(groups\\u001b[38;5;241m.\\u001b[39mgroups\\u001b[38;5;241m.\\u001b[39mkeys())\\n\\u001b[1;32m    100\\u001b[0m metrics_per_group \\u001b[38;5;241m=\\u001b[39m groups\\u001b[38;5;241m.\\u001b[39mapply(\\n\\u001b[0;32m--> 101\\u001b[0m     \\u001b[38;5;28;01mlambda\\u001b[39;00m group: \\u001b[43mcalculate_metrics_for_group\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mmetrics\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m,\\n\\u001b[1;32m    102\\u001b[0m )\\u001b[38;5;241m.\\u001b[39mvalues\\n\\u001b[1;32m    104\\u001b[0m y_values \\u001b[38;5;241m=\\u001b[39m []\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:85\\u001b[0m, in \\u001b[0;36mcalculate_metrics_for_group\\u001b[0;34m(metrics, group)\\u001b[0m\\n\\u001b[1;32m     83\\u001b[0m values \\u001b[38;5;241m=\\u001b[39m {}\\n\\u001b[0;32m---> 85\\u001b[0m \\u001b[38;5;28;01mfor\\u001b[39;00m metric \\u001b[38;5;129;01min\\u001b[39;00m metrics:\\n\\u001b[1;32m     86\\u001b[0m     aggregation \\u001b[38;5;241m=\\u001b[39m metric[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124maggregation\\u001b[39m\\u001b[38;5;124m'\\u001b[39m]\\n\", \"\\u001b[0;31mTypeError\\u001b[0m: 'NoneType' object is not iterable\", \"\\nDuring handling of the above exception, another exception occurred:\\n\", \"\\u001b[0;31mTypeError\\u001b[0m                                 Traceback (most recent call last)\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/__init__.py:96\\u001b[0m, in \\u001b[0;36mWidget.post_process_variables\\u001b[0;34m(self, variables, code, results, upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m     94\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m should_use_no_code:\\n\\u001b[1;32m     95\\u001b[0m     df \\u001b[38;5;241m=\\u001b[39m dfs[\\u001b[38;5;241m0\\u001b[39m]\\n\\u001b[0;32m---> 96\\u001b[0m     data \\u001b[38;5;241m=\\u001b[39m \\u001b[43mbuild_x_y\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mdf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mgroup_by_columns\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mmetrics\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     97\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m     98\\u001b[0m     data[VARIABLE_NAME_X] \\u001b[38;5;241m=\\u001b[39m encode_values_in_list(\\n\\u001b[1;32m     99\\u001b[0m         convert_to_list(variables[VARIABLE_NAME_X])\\n\\u001b[1;32m    100\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:100\\u001b[0m, in \\u001b[0;36mbuild_x_y\\u001b[0;34m(df, group_by_columns, metrics)\\u001b[0m\\n\\u001b[1;32m     97\\u001b[0m groups \\u001b[38;5;241m=\\u001b[39m df\\u001b[38;5;241m.\\u001b[39mgroupby(group_by_columns)\\n\\u001b[1;32m     98\\u001b[0m data[VARIABLE_NAME_X] \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(groups\\u001b[38;5;241m.\\u001b[39mgroups\\u001b[38;5;241m.\\u001b[39mkeys())\\n\\u001b[0;32m--> 100\\u001b[0m metrics_per_group \\u001b[38;5;241m=\\u001b[39m \\u001b[43mgroups\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mapply\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    101\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[38;5;28;43;01mlambda\\u001b[39;49;00m\\u001b[43m \\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m:\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mcalculate_metrics_for_group\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mmetrics\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    102\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\u001b[38;5;241m.\\u001b[39mvalues\\n\\u001b[1;32m    104\\u001b[0m y_values \\u001b[38;5;241m=\\u001b[39m []\\n\\u001b[1;32m    105\\u001b[0m \\u001b[38;5;28;01mfor\\u001b[39;00m idx, metric \\u001b[38;5;129;01min\\u001b[39;00m \\u001b[38;5;28menumerate\\u001b[39m(metrics):\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1588\\u001b[0m, in \\u001b[0;36mGroupBy.apply\\u001b[0;34m(self, func, *args, **kwargs)\\u001b[0m\\n\\u001b[1;32m   1580\\u001b[0m             new_msg \\u001b[38;5;241m=\\u001b[39m (\\n\\u001b[1;32m   1581\\u001b[0m                 \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mThe operation \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00morig_func\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m failed on a column. If any error \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m   1582\\u001b[0m                 \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mis raised, this will raise an exception in a future version \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m   1583\\u001b[0m                 \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mof pandas. Drop these columns to avoid this warning.\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m   1584\\u001b[0m             )\\n\\u001b[1;32m   1585\\u001b[0m             \\u001b[38;5;28;01mwith\\u001b[39;00m rewrite_warning(\\n\\u001b[1;32m   1586\\u001b[0m                 old_msg, \\u001b[38;5;167;01mFutureWarning\\u001b[39;00m, new_msg\\n\\u001b[1;32m   1587\\u001b[0m             ) \\u001b[38;5;28;01mif\\u001b[39;00m is_np_func \\u001b[38;5;28;01melse\\u001b[39;00m nullcontext():\\n\\u001b[0;32m-> 1588\\u001b[0m                 \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_python_apply_general\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_selected_obj\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m   1590\\u001b[0m \\u001b[38;5;28;01mreturn\\u001b[39;00m result\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1629\\u001b[0m, in \\u001b[0;36mGroupBy._python_apply_general\\u001b[0;34m(self, f, data, not_indexed_same, is_transform, is_agg)\\u001b[0m\\n\\u001b[1;32m   1592\\u001b[0m \\u001b[38;5;129m@final\\u001b[39m\\n\\u001b[1;32m   1593\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m_python_apply_general\\u001b[39m(\\n\\u001b[1;32m   1594\\u001b[0m     \\u001b[38;5;28mself\\u001b[39m,\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m   1599\\u001b[0m     is_agg: \\u001b[38;5;28mbool\\u001b[39m \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m   1600\\u001b[0m ) \\u001b[38;5;241m-\\u001b[39m\\u001b[38;5;241m>\\u001b[39m NDFrameT:\\n\\u001b[1;32m   1601\\u001b[0m \\u001b[38;5;250m    \\u001b[39m\\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[1;32m   1602\\u001b[0m \\u001b[38;5;124;03m    Apply function f in python space\\u001b[39;00m\\n\\u001b[1;32m   1603\\u001b[0m \\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m   1627\\u001b[0m \\u001b[38;5;124;03m        data after applying f\\u001b[39;00m\\n\\u001b[1;32m   1628\\u001b[0m \\u001b[38;5;124;03m    \\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[0;32m-> 1629\\u001b[0m     values, mutated \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mgrouper\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mapply\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mdata\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43maxis\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m   1630\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m not_indexed_same \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m   1631\\u001b[0m         not_indexed_same \\u001b[38;5;241m=\\u001b[39m mutated \\u001b[38;5;129;01mor\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mmutated\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/ops.py:839\\u001b[0m, in \\u001b[0;36mBaseGrouper.apply\\u001b[0;34m(self, f, data, axis)\\u001b[0m\\n\\u001b[1;32m    837\\u001b[0m \\u001b[38;5;66;03m# group might be modified\\u001b[39;00m\\n\\u001b[1;32m    838\\u001b[0m group_axes \\u001b[38;5;241m=\\u001b[39m group\\u001b[38;5;241m.\\u001b[39maxes\\n\\u001b[0;32m--> 839\\u001b[0m res \\u001b[38;5;241m=\\u001b[39m \\u001b[43mf\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    840\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m mutated \\u001b[38;5;129;01mand\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m _is_indexed_like(res, group_axes, axis):\\n\\u001b[1;32m    841\\u001b[0m     mutated \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;01mTrue\\u001b[39;00m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:101\\u001b[0m, in \\u001b[0;36mbuild_x_y.<locals>.<lambda>\\u001b[0;34m(group)\\u001b[0m\\n\\u001b[1;32m     97\\u001b[0m groups \\u001b[38;5;241m=\\u001b[39m df\\u001b[38;5;241m.\\u001b[39mgroupby(group_by_columns)\\n\\u001b[1;32m     98\\u001b[0m data[VARIABLE_NAME_X] \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(groups\\u001b[38;5;241m.\\u001b[39mgroups\\u001b[38;5;241m.\\u001b[39mkeys())\\n\\u001b[1;32m    100\\u001b[0m metrics_per_group \\u001b[38;5;241m=\\u001b[39m groups\\u001b[38;5;241m.\\u001b[39mapply(\\n\\u001b[0;32m--> 101\\u001b[0m     \\u001b[38;5;28;01mlambda\\u001b[39;00m group: \\u001b[43mcalculate_metrics_for_group\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mmetrics\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m,\\n\\u001b[1;32m    102\\u001b[0m )\\u001b[38;5;241m.\\u001b[39mvalues\\n\\u001b[1;32m    104\\u001b[0m y_values \\u001b[38;5;241m=\\u001b[39m []\\n\\u001b[1;32m    105\\u001b[0m \\u001b[38;5;28;01mfor\\u001b[39;00m idx, metric \\u001b[38;5;129;01min\\u001b[39;00m \\u001b[38;5;28menumerate\\u001b[39m(metrics):\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:85\\u001b[0m, in \\u001b[0;36mcalculate_metrics_for_group\\u001b[0;34m(metrics, group)\\u001b[0m\\n\\u001b[1;32m     82\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21mcalculate_metrics_for_group\\u001b[39m(metrics, group):\\n\\u001b[1;32m     83\\u001b[0m     values \\u001b[38;5;241m=\\u001b[39m {}\\n\\u001b[0;32m---> 85\\u001b[0m     \\u001b[38;5;28;01mfor\\u001b[39;00m metric \\u001b[38;5;129;01min\\u001b[39;00m metrics:\\n\\u001b[1;32m     86\\u001b[0m         aggregation \\u001b[38;5;241m=\\u001b[39m metric[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124maggregation\\u001b[39m\\u001b[38;5;124m'\\u001b[39m]\\n\\u001b[1;32m     87\\u001b[0m         column \\u001b[38;5;241m=\\u001b[39m metric[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mcolumn\\u001b[39m\\u001b[38;5;124m'\\u001b[39m]\\n\", \"\\u001b[0;31mTypeError\\u001b[0m: 'NoneType' object is not iterable\"], \"error\": [\"\\u001b[0;31m---------------------------------------------------------------------------\\u001b[0m\", \"\\u001b[0;31mTypeError\\u001b[0m                                 Traceback (most recent call last)\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1567\\u001b[0m, in \\u001b[0;36mGroupBy.apply\\u001b[0;34m(self, func, *args, **kwargs)\\u001b[0m\\n\\u001b[1;32m   1564\\u001b[0m     \\u001b[38;5;28;01mwith\\u001b[39;00m rewrite_warning(\\n\\u001b[1;32m   1565\\u001b[0m         old_msg, \\u001b[38;5;167;01mFutureWarning\\u001b[39;00m, new_msg\\n\\u001b[1;32m   1566\\u001b[0m     ) \\u001b[38;5;28;01mif\\u001b[39;00m is_np_func \\u001b[38;5;28;01melse\\u001b[39;00m nullcontext():\\n\\u001b[0;32m-> 1567\\u001b[0m         result \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_python_apply_general\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_selected_obj\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m   1568\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mTypeError\\u001b[39;00m:\\n\\u001b[1;32m   1569\\u001b[0m     \\u001b[38;5;66;03m# gh-20949\\u001b[39;00m\\n\\u001b[1;32m   1570\\u001b[0m     \\u001b[38;5;66;03m# try again, with .apply acting as a filtering\\u001b[39;00m\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m   1574\\u001b[0m     \\u001b[38;5;66;03m# fails on *some* columns, e.g. a numeric operation\\u001b[39;00m\\n\\u001b[1;32m   1575\\u001b[0m     \\u001b[38;5;66;03m# on a string grouper column\\u001b[39;00m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1629\\u001b[0m, in \\u001b[0;36mGroupBy._python_apply_general\\u001b[0;34m(self, f, data, not_indexed_same, is_transform, is_agg)\\u001b[0m\\n\\u001b[1;32m   1601\\u001b[0m \\u001b[38;5;250m\\u001b[39m\\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[1;32m   1602\\u001b[0m \\u001b[38;5;124;03mApply function f in python space\\u001b[39;00m\\n\\u001b[1;32m   1603\\u001b[0m \\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m   1627\\u001b[0m \\u001b[38;5;124;03m    data after applying f\\u001b[39;00m\\n\\u001b[1;32m   1628\\u001b[0m \\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[0;32m-> 1629\\u001b[0m values, mutated \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mgrouper\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mapply\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mdata\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43maxis\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m   1630\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m not_indexed_same \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/ops.py:839\\u001b[0m, in \\u001b[0;36mBaseGrouper.apply\\u001b[0;34m(self, f, data, axis)\\u001b[0m\\n\\u001b[1;32m    838\\u001b[0m group_axes \\u001b[38;5;241m=\\u001b[39m group\\u001b[38;5;241m.\\u001b[39maxes\\n\\u001b[0;32m--> 839\\u001b[0m res \\u001b[38;5;241m=\\u001b[39m \\u001b[43mf\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    840\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m mutated \\u001b[38;5;129;01mand\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m _is_indexed_like(res, group_axes, axis):\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:101\\u001b[0m, in \\u001b[0;36mbuild_x_y.<locals>.<lambda>\\u001b[0;34m(group)\\u001b[0m\\n\\u001b[1;32m     98\\u001b[0m data[VARIABLE_NAME_X] \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(groups\\u001b[38;5;241m.\\u001b[39mgroups\\u001b[38;5;241m.\\u001b[39mkeys())\\n\\u001b[1;32m    100\\u001b[0m metrics_per_group \\u001b[38;5;241m=\\u001b[39m groups\\u001b[38;5;241m.\\u001b[39mapply(\\n\\u001b[0;32m--> 101\\u001b[0m     \\u001b[38;5;28;01mlambda\\u001b[39;00m group: \\u001b[43mcalculate_metrics_for_group\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mmetrics\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m,\\n\\u001b[1;32m    102\\u001b[0m )\\u001b[38;5;241m.\\u001b[39mvalues\\n\\u001b[1;32m    104\\u001b[0m y_values \\u001b[38;5;241m=\\u001b[39m []\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:85\\u001b[0m, in \\u001b[0;36mcalculate_metrics_for_group\\u001b[0;34m(metrics, group)\\u001b[0m\\n\\u001b[1;32m     83\\u001b[0m values \\u001b[38;5;241m=\\u001b[39m {}\\n\\u001b[0;32m---> 85\\u001b[0m \\u001b[38;5;28;01mfor\\u001b[39;00m metric \\u001b[38;5;129;01min\\u001b[39;00m metrics:\\n\\u001b[1;32m     86\\u001b[0m     aggregation \\u001b[38;5;241m=\\u001b[39m metric[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124maggregation\\u001b[39m\\u001b[38;5;124m'\\u001b[39m]\\n\", \"\\u001b[0;31mTypeError\\u001b[0m: 'NoneType' object is not iterable\", \"\\nDuring handling of the above exception, another exception occurred:\\n\", \"\\u001b[0;31mTypeError\\u001b[0m                                 Traceback (most recent call last)\", \"Cell \\u001b[0;32mIn[6], line 67\\u001b[0m\\n\\u001b[1;32m     64\\u001b[0m     \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m     65\\u001b[0m         \\u001b[38;5;28;01mreturn\\u001b[39;00m find(\\u001b[38;5;28;01mlambda\\u001b[39;00m val: val \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m, output)\\n\\u001b[0;32m---> 67\\u001b[0m df \\u001b[38;5;241m=\\u001b[39m \\u001b[43mexecute_custom_code\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     69\\u001b[0m \\u001b[38;5;66;03m# Post processing code below (source: output_display.py)\\u001b[39;00m\\n\\u001b[1;32m     72\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m__custom_output\\u001b[39m():\\n\", \"Cell \\u001b[0;32mIn[6], line 45\\u001b[0m, in \\u001b[0;36mexecute_custom_code\\u001b[0;34m()\\u001b[0m\\n\\u001b[1;32m     42\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m:\\n\\u001b[1;32m     43\\u001b[0m     \\u001b[38;5;28;01mpass\\u001b[39;00m\\n\\u001b[0;32m---> 45\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m \\u001b[43mblock\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_with_callback\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m     46\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcode\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     47\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     48\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43manalyze_outputs\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mFalse\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     49\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mrun_settings\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mjson\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mloads\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[38;5;132;43;01m{}\\u001b[39;49;00m\\u001b[38;5;124;43m'\\u001b[39;49m\\u001b[43m)\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     50\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mupdate_status\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     51\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[38;5;28;43;01mTrue\\u001b[39;49;00m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m     52\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     53\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m     54\\u001b[0m     block\\u001b[38;5;241m.\\u001b[39mrun_tests(\\n\\u001b[1;32m     55\\u001b[0m         custom_code\\u001b[38;5;241m=\\u001b[39mcode,\\n\\u001b[1;32m     56\\u001b[0m         global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m     57\\u001b[0m         from_notebook\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mTrue\\u001b[39;00m,\\n\\u001b[1;32m     58\\u001b[0m         update_tests\\u001b[38;5;241m=\\u001b[39m\\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m     59\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:603\\u001b[0m, in \\u001b[0;36mBlock.execute_with_callback\\u001b[0;34m(self, global_vars, logger, logging_tags, **kwargs)\\u001b[0m\\n\\u001b[1;32m    596\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block:\\n\\u001b[1;32m    597\\u001b[0m         \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block\\u001b[38;5;241m.\\u001b[39mexecute_callback(\\n\\u001b[1;32m    598\\u001b[0m             \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mon_failure\\u001b[39m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    599\\u001b[0m             global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m    600\\u001b[0m             logger\\u001b[38;5;241m=\\u001b[39mlogger,\\n\\u001b[1;32m    601\\u001b[0m             logging_tags\\u001b[38;5;241m=\\u001b[39mlogging_tags,\\n\\u001b[1;32m    602\\u001b[0m         )\\n\\u001b[0;32m--> 603\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m e\\n\\u001b[1;32m    605\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block:\\n\\u001b[1;32m    606\\u001b[0m     \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block\\u001b[38;5;241m.\\u001b[39mexecute_callback(\\n\\u001b[1;32m    607\\u001b[0m         \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mon_success\\u001b[39m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    608\\u001b[0m         global_vars\\u001b[38;5;241m=\\u001b[39mglobal_vars,\\n\\u001b[1;32m    609\\u001b[0m         logger\\u001b[38;5;241m=\\u001b[39mlogger,\\n\\u001b[1;32m    610\\u001b[0m         logging_tags\\u001b[38;5;241m=\\u001b[39mlogging_tags,\\n\\u001b[1;32m    611\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:589\\u001b[0m, in \\u001b[0;36mBlock.execute_with_callback\\u001b[0;34m(self, global_vars, logger, logging_tags, **kwargs)\\u001b[0m\\n\\u001b[1;32m    582\\u001b[0m \\u001b[38;5;250m\\u001b[39m\\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[1;32m    583\\u001b[0m \\u001b[38;5;124;03mThis method will execute the block and run the callback functions if they exist\\u001b[39;00m\\n\\u001b[1;32m    584\\u001b[0m \\u001b[38;5;124;03mfor this block. This function should only be used when running a block from the\\u001b[39;00m\\n\\u001b[1;32m    585\\u001b[0m \\u001b[38;5;124;03mwebsocket as a way to test the code in the callback. To run a block in a pipeline\\u001b[39;00m\\n\\u001b[1;32m    586\\u001b[0m \\u001b[38;5;124;03mrun, use a BlockExecutor.\\u001b[39;00m\\n\\u001b[1;32m    587\\u001b[0m \\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[1;32m    588\\u001b[0m \\u001b[38;5;28;01mtry\\u001b[39;00m:\\n\\u001b[0;32m--> 589\\u001b[0m     output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_sync\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    590\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    591\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    592\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    593\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[38;5;241;43m*\\u001b[39;49m\\u001b[43mkwargs\\u001b[49m\\n\\u001b[1;32m    594\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    595\\u001b[0m \\u001b[38;5;28;01mexcept\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m \\u001b[38;5;28;01mas\\u001b[39;00m e:\\n\\u001b[1;32m    596\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mcallback_block:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:721\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids, run_settings)\\u001b[0m\\n\\u001b[1;32m    712\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m logger \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m    713\\u001b[0m         logger\\u001b[38;5;241m.\\u001b[39mexception(\\n\\u001b[1;32m    714\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mFailed to execute block \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m,\\n\\u001b[1;32m    715\\u001b[0m             \\u001b[38;5;241m*\\u001b[39m\\u001b[38;5;241m*\\u001b[39mmerge_dict(logging_tags, \\u001b[38;5;28mdict\\u001b[39m(\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m    719\\u001b[0m             ))\\n\\u001b[1;32m    720\\u001b[0m         )\\n\\u001b[0;32m--> 721\\u001b[0m     \\u001b[38;5;28;01mraise\\u001b[39;00m err\\n\\u001b[1;32m    722\\u001b[0m \\u001b[38;5;28;01mfinally\\u001b[39;00m:\\n\\u001b[1;32m    723\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m update_status:\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:652\\u001b[0m, in \\u001b[0;36mBlock.execute_sync\\u001b[0;34m(self, analyze_outputs, build_block_output_stdout, custom_code, execution_partition, global_vars, logger, logging_tags, run_all_blocks, test_execution, update_status, store_variables, verify_output, input_from_output, runtime_arguments, dynamic_block_index, dynamic_block_uuid, dynamic_upstream_block_uuids, run_settings)\\u001b[0m\\n\\u001b[1;32m    645\\u001b[0m         \\u001b[38;5;28;01mraise\\u001b[39;00m \\u001b[38;5;167;01mException\\u001b[39;00m(\\n\\u001b[1;32m    646\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mBlock \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00m\\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39muuid\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124ms upstream blocks have not been executed yet. \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m    647\\u001b[0m             \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mPlease run upstream blocks \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00mupstream_block_uuids\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m \\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    648\\u001b[0m             \\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mbefore running the current block.\\u001b[39m\\u001b[38;5;124m'\\u001b[39m\\n\\u001b[1;32m    649\\u001b[0m         )\\n\\u001b[1;32m    650\\u001b[0m global_vars \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m__enrich_global_vars(global_vars)\\n\\u001b[0;32m--> 652\\u001b[0m output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mexecute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    653\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mbuild_block_output_stdout\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    654\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    655\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    656\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    657\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    658\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    659\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    660\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    661\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    662\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_block_index\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    663\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mdynamic_upstream_block_uuids\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    664\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43mrun_settings\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mrun_settings\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    665\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    666\\u001b[0m block_output \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mpost_process_output(output)\\n\\u001b[1;32m    667\\u001b[0m variable_mapping \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m()\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:889\\u001b[0m, in \\u001b[0;36mBlock.execute_block\\u001b[0;34m(self, build_block_output_stdout, custom_code, execution_partition, input_args, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, dynamic_block_index, dynamic_upstream_block_uuids, run_settings)\\u001b[0m\\n\\u001b[1;32m    886\\u001b[0m     \\u001b[38;5;28;01mfor\\u001b[39;00m kwargs_var \\u001b[38;5;129;01min\\u001b[39;00m kwargs_vars:\\n\\u001b[1;32m    887\\u001b[0m         global_vars_copy\\u001b[38;5;241m.\\u001b[39mupdate(kwargs_var)\\n\\u001b[0;32m--> 889\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_execute_block\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    890\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43moutputs_from_input_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    891\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mcustom_code\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    892\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mexecution_partition\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    893\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_vars\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    894\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogger\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogger\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    895\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mlogging_tags\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    896\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mglobal_vars\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mglobal_vars_copy\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    897\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mtest_execution\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mtest_execution\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    898\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43minput_from_output\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43minput_from_output\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    899\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mruntime_arguments\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    900\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    901\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mrun_settings\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mrun_settings\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    902\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    904\\u001b[0m output_message \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mdict\\u001b[39m(output\\u001b[38;5;241m=\\u001b[39moutputs)\\n\\u001b[1;32m    906\\u001b[0m \\u001b[38;5;28;01mreturn\\u001b[39;00m output_message\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py:944\\u001b[0m, in \\u001b[0;36mBlock._execute_block\\u001b[0;34m(self, outputs_from_input_vars, custom_code, execution_partition, input_vars, logger, logging_tags, global_vars, test_execution, input_from_output, runtime_arguments, upstream_block_uuids, run_settings)\\u001b[0m\\n\\u001b[1;32m    942\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m BlockType\\u001b[38;5;241m.\\u001b[39mCHART \\u001b[38;5;241m==\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mtype:\\n\\u001b[1;32m    943\\u001b[0m     variables \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mget_variables_from_code_execution(results)\\n\\u001b[0;32m--> 944\\u001b[0m     outputs \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mpost_process_variables\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    945\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mvariables\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    946\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mcode\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mcustom_code\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    947\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mresults\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mresults\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    948\\u001b[0m \\u001b[43m        \\u001b[49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[38;5;241;43m=\\u001b[39;49m\\u001b[43mupstream_block_uuids\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    949\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    950\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m    951\\u001b[0m     block_function \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39m_validate_execution(decorated_functions, input_vars)\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/__init__.py:96\\u001b[0m, in \\u001b[0;36mWidget.post_process_variables\\u001b[0;34m(self, variables, code, results, upstream_block_uuids)\\u001b[0m\\n\\u001b[1;32m     94\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m should_use_no_code:\\n\\u001b[1;32m     95\\u001b[0m     df \\u001b[38;5;241m=\\u001b[39m dfs[\\u001b[38;5;241m0\\u001b[39m]\\n\\u001b[0;32m---> 96\\u001b[0m     data \\u001b[38;5;241m=\\u001b[39m \\u001b[43mbuild_x_y\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mdf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mgroup_by_columns\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mmetrics\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m     97\\u001b[0m \\u001b[38;5;28;01melse\\u001b[39;00m:\\n\\u001b[1;32m     98\\u001b[0m     data[VARIABLE_NAME_X] \\u001b[38;5;241m=\\u001b[39m encode_values_in_list(\\n\\u001b[1;32m     99\\u001b[0m         convert_to_list(variables[VARIABLE_NAME_X])\\n\\u001b[1;32m    100\\u001b[0m     )\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:100\\u001b[0m, in \\u001b[0;36mbuild_x_y\\u001b[0;34m(df, group_by_columns, metrics)\\u001b[0m\\n\\u001b[1;32m     97\\u001b[0m groups \\u001b[38;5;241m=\\u001b[39m df\\u001b[38;5;241m.\\u001b[39mgroupby(group_by_columns)\\n\\u001b[1;32m     98\\u001b[0m data[VARIABLE_NAME_X] \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(groups\\u001b[38;5;241m.\\u001b[39mgroups\\u001b[38;5;241m.\\u001b[39mkeys())\\n\\u001b[0;32m--> 100\\u001b[0m metrics_per_group \\u001b[38;5;241m=\\u001b[39m \\u001b[43mgroups\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mapply\\u001b[49m\\u001b[43m(\\u001b[49m\\n\\u001b[1;32m    101\\u001b[0m \\u001b[43m    \\u001b[49m\\u001b[38;5;28;43;01mlambda\\u001b[39;49;00m\\u001b[43m \\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m:\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mcalculate_metrics_for_group\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mmetrics\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m\\u001b[43m,\\u001b[49m\\n\\u001b[1;32m    102\\u001b[0m \\u001b[43m\\u001b[49m\\u001b[43m)\\u001b[49m\\u001b[38;5;241m.\\u001b[39mvalues\\n\\u001b[1;32m    104\\u001b[0m y_values \\u001b[38;5;241m=\\u001b[39m []\\n\\u001b[1;32m    105\\u001b[0m \\u001b[38;5;28;01mfor\\u001b[39;00m idx, metric \\u001b[38;5;129;01min\\u001b[39;00m \\u001b[38;5;28menumerate\\u001b[39m(metrics):\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1588\\u001b[0m, in \\u001b[0;36mGroupBy.apply\\u001b[0;34m(self, func, *args, **kwargs)\\u001b[0m\\n\\u001b[1;32m   1580\\u001b[0m             new_msg \\u001b[38;5;241m=\\u001b[39m (\\n\\u001b[1;32m   1581\\u001b[0m                 \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mThe operation \\u001b[39m\\u001b[38;5;132;01m{\\u001b[39;00morig_func\\u001b[38;5;132;01m}\\u001b[39;00m\\u001b[38;5;124m failed on a column. If any error \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m   1582\\u001b[0m                 \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mis raised, this will raise an exception in a future version \\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m   1583\\u001b[0m                 \\u001b[38;5;124mf\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\u001b[38;5;124mof pandas. Drop these columns to avoid this warning.\\u001b[39m\\u001b[38;5;124m\\\"\\u001b[39m\\n\\u001b[1;32m   1584\\u001b[0m             )\\n\\u001b[1;32m   1585\\u001b[0m             \\u001b[38;5;28;01mwith\\u001b[39;00m rewrite_warning(\\n\\u001b[1;32m   1586\\u001b[0m                 old_msg, \\u001b[38;5;167;01mFutureWarning\\u001b[39;00m, new_msg\\n\\u001b[1;32m   1587\\u001b[0m             ) \\u001b[38;5;28;01mif\\u001b[39;00m is_np_func \\u001b[38;5;28;01melse\\u001b[39;00m nullcontext():\\n\\u001b[0;32m-> 1588\\u001b[0m                 \\u001b[38;5;28;01mreturn\\u001b[39;00m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_python_apply_general\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43m_selected_obj\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m   1590\\u001b[0m \\u001b[38;5;28;01mreturn\\u001b[39;00m result\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:1629\\u001b[0m, in \\u001b[0;36mGroupBy._python_apply_general\\u001b[0;34m(self, f, data, not_indexed_same, is_transform, is_agg)\\u001b[0m\\n\\u001b[1;32m   1592\\u001b[0m \\u001b[38;5;129m@final\\u001b[39m\\n\\u001b[1;32m   1593\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21m_python_apply_general\\u001b[39m(\\n\\u001b[1;32m   1594\\u001b[0m     \\u001b[38;5;28mself\\u001b[39m,\\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m   1599\\u001b[0m     is_agg: \\u001b[38;5;28mbool\\u001b[39m \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;01mFalse\\u001b[39;00m,\\n\\u001b[1;32m   1600\\u001b[0m ) \\u001b[38;5;241m-\\u001b[39m\\u001b[38;5;241m>\\u001b[39m NDFrameT:\\n\\u001b[1;32m   1601\\u001b[0m \\u001b[38;5;250m    \\u001b[39m\\u001b[38;5;124;03m\\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[1;32m   1602\\u001b[0m \\u001b[38;5;124;03m    Apply function f in python space\\u001b[39;00m\\n\\u001b[1;32m   1603\\u001b[0m \\n\\u001b[0;32m   (...)\\u001b[0m\\n\\u001b[1;32m   1627\\u001b[0m \\u001b[38;5;124;03m        data after applying f\\u001b[39;00m\\n\\u001b[1;32m   1628\\u001b[0m \\u001b[38;5;124;03m    \\\"\\\"\\\"\\u001b[39;00m\\n\\u001b[0;32m-> 1629\\u001b[0m     values, mutated \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mgrouper\\u001b[49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43mapply\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mf\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mdata\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[38;5;28;43mself\\u001b[39;49m\\u001b[38;5;241;43m.\\u001b[39;49m\\u001b[43maxis\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m   1630\\u001b[0m     \\u001b[38;5;28;01mif\\u001b[39;00m not_indexed_same \\u001b[38;5;129;01mis\\u001b[39;00m \\u001b[38;5;28;01mNone\\u001b[39;00m:\\n\\u001b[1;32m   1631\\u001b[0m         not_indexed_same \\u001b[38;5;241m=\\u001b[39m mutated \\u001b[38;5;129;01mor\\u001b[39;00m \\u001b[38;5;28mself\\u001b[39m\\u001b[38;5;241m.\\u001b[39mmutated\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/pandas/core/groupby/ops.py:839\\u001b[0m, in \\u001b[0;36mBaseGrouper.apply\\u001b[0;34m(self, f, data, axis)\\u001b[0m\\n\\u001b[1;32m    837\\u001b[0m \\u001b[38;5;66;03m# group might be modified\\u001b[39;00m\\n\\u001b[1;32m    838\\u001b[0m group_axes \\u001b[38;5;241m=\\u001b[39m group\\u001b[38;5;241m.\\u001b[39maxes\\n\\u001b[0;32m--> 839\\u001b[0m res \\u001b[38;5;241m=\\u001b[39m \\u001b[43mf\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m\\n\\u001b[1;32m    840\\u001b[0m \\u001b[38;5;28;01mif\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m mutated \\u001b[38;5;129;01mand\\u001b[39;00m \\u001b[38;5;129;01mnot\\u001b[39;00m _is_indexed_like(res, group_axes, axis):\\n\\u001b[1;32m    841\\u001b[0m     mutated \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28;01mTrue\\u001b[39;00m\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:101\\u001b[0m, in \\u001b[0;36mbuild_x_y.<locals>.<lambda>\\u001b[0;34m(group)\\u001b[0m\\n\\u001b[1;32m     97\\u001b[0m groups \\u001b[38;5;241m=\\u001b[39m df\\u001b[38;5;241m.\\u001b[39mgroupby(group_by_columns)\\n\\u001b[1;32m     98\\u001b[0m data[VARIABLE_NAME_X] \\u001b[38;5;241m=\\u001b[39m \\u001b[38;5;28mlist\\u001b[39m(groups\\u001b[38;5;241m.\\u001b[39mgroups\\u001b[38;5;241m.\\u001b[39mkeys())\\n\\u001b[1;32m    100\\u001b[0m metrics_per_group \\u001b[38;5;241m=\\u001b[39m groups\\u001b[38;5;241m.\\u001b[39mapply(\\n\\u001b[0;32m--> 101\\u001b[0m     \\u001b[38;5;28;01mlambda\\u001b[39;00m group: \\u001b[43mcalculate_metrics_for_group\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43mmetrics\\u001b[49m\\u001b[43m,\\u001b[49m\\u001b[43m \\u001b[49m\\u001b[43mgroup\\u001b[49m\\u001b[43m)\\u001b[49m,\\n\\u001b[1;32m    102\\u001b[0m )\\u001b[38;5;241m.\\u001b[39mvalues\\n\\u001b[1;32m    104\\u001b[0m y_values \\u001b[38;5;241m=\\u001b[39m []\\n\\u001b[1;32m    105\\u001b[0m \\u001b[38;5;28;01mfor\\u001b[39;00m idx, metric \\u001b[38;5;129;01min\\u001b[39;00m \\u001b[38;5;28menumerate\\u001b[39m(metrics):\\n\", \"File \\u001b[0;32m/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/widget/utils.py:85\\u001b[0m, in \\u001b[0;36mcalculate_metrics_for_group\\u001b[0;34m(metrics, group)\\u001b[0m\\n\\u001b[1;32m     82\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21mcalculate_metrics_for_group\\u001b[39m(metrics, group):\\n\\u001b[1;32m     83\\u001b[0m     values \\u001b[38;5;241m=\\u001b[39m {}\\n\\u001b[0;32m---> 85\\u001b[0m     \\u001b[38;5;28;01mfor\\u001b[39;00m metric \\u001b[38;5;129;01min\\u001b[39;00m metrics:\\n\\u001b[1;32m     86\\u001b[0m         aggregation \\u001b[38;5;241m=\\u001b[39m metric[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124maggregation\\u001b[39m\\u001b[38;5;124m'\\u001b[39m]\\n\\u001b[1;32m     87\\u001b[0m         column \\u001b[38;5;241m=\\u001b[39m metric[\\u001b[38;5;124m'\\u001b[39m\\u001b[38;5;124mcolumn\\u001b[39m\\u001b[38;5;124m'\\u001b[39m]\\n\", \"\\u001b[0;31mTypeError\\u001b[0m: 'NoneType' object is not iterable\"], \"execution_state\": null, \"metadata\": null, \"msg_id\": \"351c018a-07e66881ba9807a5d2577fab_7_7\", \"msg_type\": \"error\", \"type\": \"text\", \"block_type\": \"chart\", \"pipeline_uuid\": null, \"uuid\": \"histogram_for__4chan_threads_1679661093569\"}"